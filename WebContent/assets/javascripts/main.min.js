function closeEditorWarning(){return"It looks like you have been editing something -- if you leave before submitting your changes will be lost."}
$(document).ready(function(){function s(){var a=$("#modal-change-rule-remove").data("rule-index"),b=$("#modal-change-rule-remove").data("protocol"),c=$("#modal-change-rule-remove").data("source-ip"),d=$("#modal-change-rule-remove").data("destination-ip"),f=$("#modal-change-rule-remove").data("source-port"),g=$("#modal-change-rule-remove").data("destination-port"),e=$("#modal-change-rule-remove").data("action");$("#modal-delete-rule-context-page").val("anomalies_page");$("#modal-delete-rule-index-p").html(a);
$("#modal-delete-rule-index").val(a);$("#modal-delete-rule-protocol-p").html(b);$("#modal-delete-rule-protocol").val(b);$("#modal-delete-rule-source-ip-p").html(c);$("#modal-delete-rule-source-ip").val(c);$("#modal-delete-rule-destination-ip-p").html(d);$("#modal-delete-rule-destination-ip").val(d);6!=b&&17!=b&&"TCP"!=b&&"UDP"!=b?($("#modal-delete-rule-source-port").parent().parent().hide(),$("#modal-delete-rule-destination-port").parent().parent().hide()):($("#modal-delete-rule-source-port").parent().parent().show(),
$("#modal-delete-rule-destination-port").parent().parent().show(),$("#modal-delete-rule-source-port-p").html(f),$("#modal-delete-rule-source-port").val(f),$("#modal-delete-rule-destination-port-p").html(g),$("#modal-delete-rule-destination-port").val(g));$("#modal-delete-rule-action-p").html(e);$("#modal-delete-rule-action").val(e);$("#modal-delete-rule").modal("show")}function n(){$(".editable-fields").editable({params:function(a){a.rownr=$(this).parent().parent().attr("id");return a}});$(".editable-field-rule-action").editable({params:function(a){a.rownr=
$(this).parent().parent().attr("id");return a},display:function(a,b){0==a?$(this).html("<span class='label label-danger'>drop</span>"):$(this).html("<span class='label label-success'>accept</span>")}})}function p(){var a=$(this).parent().prev().prev().prev().prev().prev().prev().prev().text(),b=$(this).parent().prev().prev().prev().prev().prev().prev().children("a").text(),c=$(this).parent().prev().prev().prev().prev().prev().children("a").text(),d=$(this).parent().prev().prev().prev().prev().children("a").text(),
f=$(this).parent().prev().prev().prev().children("a").text(),g=$(this).parent().prev().prev().children("a").text(),e=$(this).parent().prev().children("a").text();$("#modal-delete-rule-context-page").val("rules_page");$("#modal-delete-rule-index-p").html(a);$("#modal-delete-rule-index").val(a);$("#modal-delete-rule-protocol-p").html(b);$("#modal-delete-rule-protocol").val(b);$("#modal-delete-rule-source-ip-p").html(c);$("#modal-delete-rule-source-ip").val(c);$("#modal-delete-rule-destination-ip-p").html(f);
$("#modal-delete-rule-destination-ip").val(f);6!=b&&17!=b&&"TCP"!=b&&"UDP"!=b?($("#modal-delete-rule-source-port").parent().parent().hide(),$("#modal-delete-rule-destination-port").parent().parent().hide()):($("#modal-delete-rule-source-port").parent().parent().show(),$("#modal-delete-rule-destination-port").parent().parent().show(),$("#modal-delete-rule-source-port-p").html(d),$("#modal-delete-rule-source-port").val(d),$("#modal-delete-rule-destination-port-p").html(g),$("#modal-delete-rule-destination-port").val(g));
$("#modal-delete-rule-action-p").html(e);$("#modal-delete-rule-action").val(e);$("#modal-delete-rule").modal("show")}var h;$(".has-popover").popover();location.hash&&$(location.hash+".collapse").collapse("show");$(".modal").draggable({cursor:"crosshair"});$(".thumbnail-link").click(function(){var a=$(this).data("href");window.location=a});$(".clear-form").on("click",function(){$("form").find("input[type=text]").val("");$("#match_protocol").val(-2);$("#match_result_div_warning").addClass("hide");$("#match_result_div_success").addClass("hide")});
$("#select-default-policy").on("change",function(){var a="action=edit_policy&select-default-policy="+$("#select-default-policy").val();$.ajax({type:"POST",url:"/my_configuration/rules;jsessionid="+$("body").data("session"),data:a,dataType:"json",error:function(a,c,d){$("#default-policy-result").text("Onverwachte fout gebeurd bij wijzigen van default policy. Server reageert niet.");$("#default-policy-result").removeClass("hide")},success:function(a){$("#default-policy-result").addClass("hide")}})});
$("#submit-button-choose-protocol").on("click",function(){var a=$("#modal-choose-protocol-getal").val(),a=$.isNumeric(a)&&0<=a&&255>=a&&!(0==a&&"0"!=a)&&!(0<a&&"0"==a.charAt(0))||-1==$("#modal-choose-protocol-option").val();if(-3!=$("#modal-choose-protocol-option").val()||a){var b=$("#modal-choose-protocol-rulenr").val(),c=$("#"+b),d=c.children(".protocol-cell a").attr("data-value"),a="action=modal_choose_protocol&modal-choose-protocol-rulenr="+b+"&modal-choose-protocol-option="+$("#modal-choose-protocol-option").val()+
"&modal-choose-protocol-getal="+$("#modal-choose-protocol-getal").val();$.ajax({type:"POST",url:"/my_configuration/rules;jsessionid="+$("body").data("session"),data:a,dataType:"json",error:function(a,b,c){$("#choose-protocol-error").text("Fout bij verzenden van AJAX request.");$("#choose-protocol-error").removeClass("hide")},success:function(a){$("#choose-protocol-error").addClass("hide");$("#modal-choose-protocol").modal("hide");$.each(a,function(a,e){var f="",f=-1==e?'<a class="editable-fields editable-field-rule-protocol editable editable-click" data-value="-1" data-prepend="true" data-title="Protocol bewerken" data-name="protocol" data-type="text" data-pk="'+
b+'" data-source="/my_configuration/rules?action=get_protocols" data-url="/my_configuration/rules?action=edit" href="#">*</a>':1==e?'<a class="editable-fields editable-field-rule-protocol editable editable-click" data-value="1" data-prepend="true" data-title="Protocol bewerken" data-name="protocol" data-type="text" data-pk="'+b+'" data-source="/my_configuration/rules?action=get_protocols" data-url="/my_configuration/rules?action=edit" href="#">ICMP</a>':6==e?'<a class="editable-fields editable-field-rule-protocol editable editable-click" data-value="6" data-prepend="true" data-title="Protocol bewerken" data-name="protocol" data-type="text" data-pk="'+
b+'" data-source="/my_configuration/rules?action=get_protocols" data-url="/my_configuration/rules?action=edit" href="#">TCP</a>':17==e?'<a class="editable-fields editable-field-rule-protocol editable editable-click" data-value="17" data-prepend="true" data-title="Protocol bewerken" data-name="protocol" data-type="text" data-pk="'+b+'" data-source="/my_configuration/rules?action=get_protocols" data-url="/my_configuration/rules?action=edit" href="#">UDP</a>':'<a class="editable-fields editable-field-rule-protocol editable editable-click" data-value="'+
e+'" data-prepend="true" data-title="Protocol bewerken" data-name="protocol" data-type="text" data-pk="'+b+'" data-source="/my_configuration/rules?action=get_protocols" data-url="/my_configuration/rules?action=edit" href="#">'+e+"</a>";c.children(".protocol-cell").html(f);if("6"!=e&&"17"!=e)c.children(".source-port-cell").html(""),c.children(".destination-port-cell").html("");else if((6==e||17==e)&&6!=d&&17!=d){var f='<a class="editable-fields editable editable-click" data-value="*" data-title="Bronpoort bewerken" data-name="source-port" data-type="text" data-pk="'+
b+'" data-url="/my_configuration/rules?action=edit" href="#">*</a>',l='<a class="editable-fields editable editable-click" data-value="*" data-title="Doelpoort bewerken" data-name="destination-port" data-type="text" data-pk="'+b+'" data-url="/my_configuration/rules?action=edit" href="#">*</a>';c.children(".source-port-cell").html(f);c.children(".destination-port-cell").html(l)}})}})}else $("#choose-protocol-error").text("Protocol getal onjuist. Het protocol getal moet een getal zijn tussen 0 en 255."),
$("#choose-protocol-error").removeClass("hide")});$("#modal-add-rule-protocol-select").on("change",function(){var a=$("#modal-add-rule-protocol-select").val();"6"==a||"17"==a?($("#modal-add-rule-source-port").css("visibility","visible"),$("#modal-add-rule-destination-port").css("visibility","visible"),$("#modal-add-rule-source-port-text").css("visibility","visible"),$("#modal-add-rule-destination-port-text").css("visibility","visible"),$("#modal-add-rule-source-port").next().show(),$("#modal-add-rule-destination-port").next().show()):
($("#modal-add-rule-source-port").css("visibility","hidden"),$("#modal-add-rule-destination-port").css("visibility","hidden"),$("#modal-add-rule-source-port-text").css("visibility","hidden"),$("#modal-add-rule-destination-port-text").css("visibility","hidden"),$("#modal-add-rule-source-port").next().hide(),$("#modal-add-rule-destination-port").next().hide());6==a?($("#modal-add-rule-protocol-getal").next().hide(),$("#modal-add-rule-protocol-getal").val("6"),$("#modal-add-rule-protocol-getal").attr("disabled",
"disabled")):17==a?($("#modal-add-rule-protocol-getal").next().hide(),$("#modal-add-rule-protocol-getal").val("17"),$("#modal-add-rule-protocol-getal").attr("disabled","disabled")):1==a?($("#modal-add-rule-protocol-getal").next().hide(),$("#modal-add-rule-protocol-getal").val("1"),$("#modal-add-rule-protocol-getal").attr("disabled","disabled")):-1==a?($("#modal-add-rule-protocol-getal").next().hide(),$("#modal-add-rule-protocol-getal").removeAttr("placeholder"),$("#modal-add-rule-protocol-getal").val(""),
$("#modal-add-rule-protocol-getal").attr("disabled","disabled")):($("#modal-add-rule-protocol-getal").next().show(),$("#modal-add-rule-protocol-getal").removeAttr("disabled"),$("#modal-add-rule-protocol-getal").attr("placeholder","protocol getal"),$("#modal-add-rule-protocol-getal").val(""))});$("#table-rules").on("click","td.protocol-cell a",function(){$(this).parent().children("div").hide();$("#choose-protocol-error").addClass("hide");var a=$(this).parent().parent().find(".sorting_2").text();$("#modal-choose-protocol-rulenr").val(a);
$("span#rulenr").text(a);a=$(this).text();"TCP"==a?($("#modal-choose-protocol-getal").val("6"),$("#modal-choose-protocol-getal").attr("disabled","disabled"),$("#modal-choose-protocol-option").val("6")):"UDP"==a?($("#modal-choose-protocol-getal").val("17"),$("#modal-choose-protocol-getal").attr("disabled","disabled"),$("#modal-choose-protocol-option").val("17")):"ICMP"==a?($("#modal-choose-protocol-getal").val("1"),$("#modal-choose-protocol-getal").attr("disabled","disabled"),$("#modal-choose-protocol-option").val("1")):
"*"==a?($("#modal-choose-protocol-getal").val(""),$("#modal-choose-protocol-getal").attr("disabled","disabled"),$("#modal-choose-protocol-option").val("-1")):($("#modal-choose-protocol-getal").val(a),$("#modal-choose-protocol-getal").removeAttr("disabled"),$("#modal-choose-protocol-option").val("-3"));$("#modal-choose-protocol").modal("show")});$("#modal-choose-protocol-option").on("change",function(){$("#choose-protocol-error").addClass("hide");var a=$(this).find("option").filter(":selected").val();
6==a?($("#modal-choose-protocol-getal").val("6"),$("#modal-choose-protocol-getal").attr("disabled","disabled")):17==a?($("#modal-choose-protocol-getal").val("17"),$("#modal-choose-protocol-getal").attr("disabled","disabled")):1==a?($("#modal-choose-protocol-getal").val("1"),$("#modal-choose-protocol-getal").attr("disabled","disabled")):-1==a?($("#modal-choose-protocol-getal").removeAttr("placeholder"),$("#modal-choose-protocol-getal").val(""),$("#modal-choose-protocol-getal").attr("disabled","disabled")):
($("#modal-choose-protocol-getal").attr("placeholder","Protocol getal"),$("#modal-choose-protocol-getal").removeAttr("disabled"),$("#modal-choose-protocol-getal").val(""))});$("#table-rules").on("click","td.source-ip-cell button.editable-submit",function(){var a=$(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().find("td.source-ip-cell input"),b=a.val();"*"==b||b.contains("/")||a.val(b+"/32")});$("#table-rules").on("click","td.destination-ip-cell button.editable-submit",
function(){var a=$(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().find("td.destination-ip-cell input"),b=a.val();"*"==b||b.contains("/")||a.val(b+"/32")});$("#table-rules").on("keypress","input",function(a){"13"==a.keyCode&&a.preventDefault()});$("#modal-change-rule-protocol-choose").on("change",function(){var a=$(this).val();6!=a&&17!=a?($("#modal-change-rule-source-port").css("visibility","hidden"),$("#modal-change-rule-destination-port").css("visibility",
"hidden"),$("#modal-change-rule-source-port-text").css("visibility","hidden"),$("#modal-change-rule-destination-port-text").css("visibility","hidden"),$("#modal-change-rule-source-port").next().hide(),$("#modal-change-rule-destination-port").next().hide()):($("#modal-change-rule-source-port").css("visibility","visible"),$("#modal-change-rule-destination-port").css("visibility","visible"),$("#modal-change-rule-source-port-text").css("visibility","visible"),$("#modal-change-rule-destination-port-text").css("visibility",
"visible"),$("#modal-change-rule-source-port").next().show(),$("#modal-change-rule-destination-port").next().show());-3!=a?$("#modal-change-rule-protocol-getal").next().hide():$("#modal-change-rule-protocol-getal").next().show();1==a?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val("1"),$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):6==a?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val("6"),
$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):17==a?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val("17"),$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):-1==a?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val(""),$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):($("#modal-change-rule-protocol-getal").attr("placeholder",
"protocol getal"),$("#modal-change-rule-protocol-getal").val(""),$("#modal-change-rule-protocol-getal").removeAttr("disabled"))});$(".knop-modal-stop-session").click(function(){$("#restart_modal").modal("show")});$(".knop-regel-toevoegen").click(function(){$("#form-add-rule")[0].reset();$("#modal-add-rule").modal("show")});$("#modal-export-configuration-form").submit(function(a){$("#modal-export-configuration").modal("hide")});$(".knop-export-configuration").click(function(a){a.preventDefault();$("#modal-export-configuration").modal("show")});
$("#match_protocol").on("change",function(){var a=$(this).val();-3==a?($("#match_protocol_getal").removeAttr("disabled"),$("#match_protocol_getal").val("")):(-2==a?$("#match_protocol_getal").val(""):$("#match_protocol_getal").val(""+a),$("#match_protocol_getal").attr("disabled","disabled"))});$(".knop-match-pakket").click(function(){var a=$("#match_bron_IP1").val(),b=$("#match_bron_IP2").val(),c=$("#match_bron_IP3").val(),d=$("#match_bron_IP4").val(),f=$("#match_doel_IP1").val(),g=$("#match_doel_IP2").val(),
e=$("#match_doel_IP3").val(),k=$("#match_doel_IP4").val(),l=$("#match_bronpoort").val(),h=$("#match_doelpoort").val(),m=$("#match_protocol").val(),n=!0;-3==m&&(m=$("#match_protocol_getal").val(),$.isNumeric(m)&&0<=m&&255>=m&&!(0==m&&"0"!=m||0<m&&"0"==m.charAt(0))||(n=!1));n?""==a||$.isNumeric(a)&&!(0==a&&"0"!=a||0<a&&"0"==a.charAt(0))&&0<=a&&255>=a&&"-"!=a.charAt(0)?""==b||$.isNumeric(b)&&!(0==b&&"0"!=b||0<b&&"0"==b.charAt(0))&&0<=b&&255>=b&&"-"!=b.charAt(0)?""==c||$.isNumeric(c)&&!(0==c&&"0"!=c||
0<c&&"0"==c.charAt(0))&&0<=c&&255>=c&&"-"!=c.charAt(0)?""==d||$.isNumeric(d)&&!(0==d&&"0"!=d||0<d&&"0"==d.charAt(0))&&0<=d&&255>=d&&"-"!=d.charAt(0)?""==f||$.isNumeric(f)&&!(0==f&&"0"!=f||0<f&&"0"==f.charAt(0))&&0<=f&&255>=f&&"-"!=f.charAt(0)?""==g||$.isNumeric(g)&&!(0==g&&"0"!=g||0<g&&"0"==g.charAt(0))&&0<=g&&255>=g&&"-"!=g.charAt(0)?""==e||$.isNumeric(e)&&!(0==e&&"0"!=e||0<e&&"0"==e.charAt(0))&&0<=e&&255>=e&&"-"!=e.charAt(0)?""==k||$.isNumeric(k)&&!(0==k&&"0"!=k||0<k&&"0"==k.charAt(0))&&0<=k&&255>=
k&&"-"!=k.charAt(0)?""==a&&(""!=b||""!=c||""!=d)||""==b&&(""!=a||""!=c||""!=d)||""==c&&(""!=b||""!=a||""!=d)||""==d&&(""!=b||""!=c||""!=a)?($("#match_result_warning").html("Vul a.u.b het bron IP adres volledig in."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):""==f&&(""!=g||""!=e||""!=k)||""==g&&(""!=f||""!=e||""!=k)||""==e&&(""!=g||""!=f||""!=k)||""==k&&(""!=g||""!=e||""!=f)?($("#match_result_warning").html("Vul a.u.b het doel IP adres volledig in."),
$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):""==l||$.isNumeric(l)&&!(0==l&&"0"!=l||0<l&&"0"==l.charAt(0))&&0<=l&&65535>=l?""==h||$.isNumeric(h)&&!(0==h&&"0"!=h||0<h&&"0"==h.charAt(0))&&0<=h&&65535>=h?(""==a&&(a="-2"),""==b&&(b="-2"),""==c&&(c="-2"),""==d&&(d="-2"),""==f&&(f="-2"),""==g&&(g="-2"),""==e&&(e="-2"),""==k&&(k="-2"),""==l&&(l="-2"),""==h&&(h="-2"),a="action=match&match_protocol="+m+"&match_bronpoort="+l+"&match_doelpoort="+h+"&match_bron_IP1="+
a+"&match_bron_IP2="+b+"&match_bron_IP3="+c+"&match_bron_IP4="+d+"&match_doel_IP1="+f+"&match_doel_IP2="+g+"&match_doel_IP3="+e+"&match_doel_IP4="+k,$.ajax({type:"POST",url:"/my_configuration/rules;jsessionid="+$("body").data("session"),data:a,dataType:"json",error:function(a,b,c){$("#match_result_warning").html("Fout bij verzenden van AJAX request.");$("#match_result_div_warning").removeClass("hide");$("#match_result_div_success").addClass("hide")},success:function(a){$.each(a,function(a,b){-1==
b?($("#match_result_warning").html("Dit 'pakketje' heeft met geen enkele regel een match. <br />De actie van de default policy wordt daarom uitgevoerd: <b>"+$("#select-default-policy option:selected").html()+"</b>"),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):-2==b?($("#match_result_warning").html("Een van de ingevoerde velden heeft een ongeldige waarde. Een poort is een getal van 0 tot 65535. Een IP adres bestaat uit 4 getallen van 0 tot 255."),
$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_success").html("Er is een match met regel "+b+"."),$("#match_result_div_warning").addClass("hide"),$("#match_result_div_success").removeClass("hide"))})}})):($("#match_result_warning").html("Doelpoort heeft ongeldige waarde. Een poort is een getal tussen 0 en 65535."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Bronpoort heeft ongeldige waarde. Een poort is een getal tussen 0 en 65535."),
$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Vierde getal van doel IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Derde getal van doel IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):
($("#match_result_warning").html("Tweede getal van doel IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Eerste getal van doel IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Vierde getal van bron IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),
$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Derde getal van bron IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Tweede getal van bron IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):
($("#match_result_warning").html("Eerste getal van bron IP heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide")):($("#match_result_warning").html("Protocol getal heeft ongeldige waarde. Dit getal moet tussen 0 en 255 liggen."),$("#match_result_div_warning").removeClass("hide"),$("#match_result_div_success").addClass("hide"))});n();$(".knop-regel-wijzigen").click(function(){var a=$(this).data("rule-index"),
b=$(this).data("protocol"),c=$(this).data("source-ip"),d=$(this).data("source-port"),f=$(this).data("destination-ip"),g=$(this).data("destination-port"),e=$(this).data("action");$("#modal-change-rule-index-span").html(a);$("#modal-change-rule-index").val(a);$("#modal-change-rule-source-ip").val(c);$("#modal-change-rule-source-ip").trigger("change");$("#modal-change-rule-destination-ip").val(f);$("#modal-change-rule-destination-ip").trigger("change");$("#modal-change-rule-action").val(e);$("#modal-change-rule-remove").data("rule-index",
a);a="";a="-1"==b?"*":"6"==b?"TCP":"1"==b?"ICMP":"17"==b?"UDP":""+b;$("#modal-change-rule-remove").data("protocol",a);$("#modal-change-rule-remove").data("source-ip",c);$("#modal-change-rule-remove").data("source-port",d);$("#modal-change-rule-remove").data("destination-ip",f);$("#modal-change-rule-remove").data("destination-port",g);$("#modal-change-rule-remove").data("context_page","anomalies_page");c="";0==e?c="drop":1==e&&(c="accept");$("#modal-change-rule-remove").data("action",c);6==b||1==b||
17==b||-1==b?$("#modal-change-rule-protocol-choose").val(""+b):$("#modal-change-rule-protocol-choose").val("-3");6!=b&&17!=b?($("#modal-change-rule-source-port").val(""),$("#modal-change-rule-destination-port").val(""),$("#modal-change-rule-source-port").css("visibility","hidden"),$("#modal-change-rule-destination-port").css("visibility","hidden"),$("#modal-change-rule-source-port-text").css("visibility","hidden"),$("#modal-change-rule-destination-port-text").css("visibility","hidden"),$("#modal-change-rule-source-port").next().hide(),
$("#modal-change-rule-destination-port").next().hide()):($("#modal-change-rule-source-port").val(d),$("#modal-change-rule-source-port").trigger("change"),$("#modal-change-rule-destination-port").val(g),$("#modal-change-rule-destination-port").trigger("change"),$("#modal-change-rule-source-port").css("visibility","visible"),$("#modal-change-rule-destination-port").css("visibility","visible"),$("#modal-change-rule-source-port-text").css("visibility","visible"),$("#modal-change-rule-destination-port-text").css("visibility",
"visible"),$("#modal-change-rule-source-port").next().show(),$("#modal-change-rule-destination-port").next().show());1==b?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val("1"),$("#modal-change-rule-protocol-getal").trigger("change"),$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):6==b?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val("6"),$("#modal-change-rule-protocol-getal").trigger("change"),
$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):17==b?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val("17"),$("#modal-change-rule-protocol-getal").trigger("change"),$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):-1==b?($("#modal-change-rule-protocol-getal").removeAttr("placeholder"),$("#modal-change-rule-protocol-getal").val(""),$("#modal-change-rule-protocol-getal").attr("disabled","disabled")):
($("#modal-change-rule-protocol-getal").attr("placeholder","protocol getal"),$("#modal-change-rule-protocol-getal").val(""+b),$("#modal-change-rule-protocol-getal").trigger("change"),$("#modal-change-rule-protocol-getal").removeAttr("disabled"));$("#modal-change-rule-remove").click(s);$("#modal-change-rule").modal("show")});$("#table-rules").dataTable({bProcessing:!0,bFilter:!1,bAutoWidth:!1,oLanguage:{sProcessing:"Bezig met verwerking...",sLengthMenu:"Toon _MENU_ firewallregels per pagina",sZeroRecords:"De chain bevat geen firewallregels",
sInfo:"_START_ tot _END_ van _TOTAL_ firewallregels",sInfoEmpty:"0 tot 0 van _TOTAL_ firewallregels",sSearch:"Zoeken:",sEmptyTable:"Geen firewallregels aanwezig in de chain",sInfoFiltered:"Gefilterd uit _MAX_ firewallregels",sInfoThousands:".",sLoadingRecords:"Even geduld aub...",sInfoPostFix:"",oPaginate:{sFirst:"Eerste",sLast:"Laatste",sNext:"",sPrevious:""}},fnRowCallback:function(a,b,c){c=$("td:eq(1)",a).children("a").attr("data-value");"6"!=c&&"17"!=c?($("td:eq(3)",a).children("a").hide(),$("td:eq(5)",
a).children("a").hide()):($("td:eq(3)",a).children("a").show(),$("td:eq(5)",a).children("a").show());6==c?$("td:eq(1)",a).children("a").text("TCP"):17==c?$("td:eq(1)",a).children("a").text("UDP"):1==c?$("td:eq(1)",a).children("a").text("ICMP"):-1==c&&$("td:eq(1)",a).children("a").text("*");b=b[0];$(a).attr("id",b);$(a).children(".protocol-cell").children("a").attr("data-pk",b);$(a).children(".source-ip-cell").children("a").attr("data-pk",b);$(a).children(".source-port-cell").children("a").attr("data-pk",
b);$(a).children(".destination-ip-cell").children("a").attr("data-pk",b);$(a).children(".destination-port-cell").children("a").attr("data-pk",b);$(a).children(".action-cell").children("a").attr("data-pk",b);$(a).children(".button-show-modal-delete-rule").attr("data-rule-index",b);n();return a},aoColumnDefs:[{bSortable:!1,aTargets:[7]}]}).rowReordering({sURL:"/my_configuration/rules;jsessionid="+$("body").data("session")+"?action=edit_order",sRequestType:"POST"});$("#table-logs").dataTable({bProcessing:!0,
bFilter:!1,bSort:!1,oLanguage:{sProcessing:"Bezig met verwerking...",sLengthMenu:"Toon _MENU_ logs per pagina",sZeroRecords:"Het logbestand bevat geen items",sInfo:"_START_ tot _END_ van _TOTAL_ logs",sInfoEmpty:"0 tot 0 van _TOTAL_ logs",sSearch:"Zoeken:",sEmptyTable:"Geen logs aanwezig in het logbestand",sInfoFiltered:"Gefilterd uit _MAX_ logs",sInfoThousands:".",sLoadingRecords:"Even geduld aub...",sInfoPostFix:"",oPaginate:{sFirst:"Eerste",sLast:"Laatste",sNext:"",sPrevious:""}},aoColumnDefs:[{bSortable:!1,
aTargets:[3]}]});$("#table-rules_length select").change(function(){n();$(".button-show-modal-delete-rule").click(p)});$("#table-rules-div").click(function(){n();$(".button-show-modal-delete-rule").click(p)});$(".button-show-modal-delete-rule").click(p);$("#cancel-add-rule").on("click",function(){$(".alert-success").hide()});$(".submit-delete-rule-form").click(function(){$("#form-delete-rule").submit()});$(".has-tooltip").tooltip();$(".toggle-popover").popover();$("div.flash-danger-div > button.close").click(function(a){$("div.flash-danger-div").hide()});
$("div.flash-success-div > button.close").click(function(a){$("div.flash-success-div").hide()});$("div.modal-add-rule-alert > button.close").click(function(a){$("div.modal-add-rule-alert").hide()});var q={delay:100,silentSubmit:!1,disableSubmitBtn:!1},r=[["#modal-add-rule-protocol-getal",function(a){return-1!=$("#modal-add-rule-protocol-select").val()?$.isNumeric(a)&&255>=a&&0<=a&&!(0==a&&"0"!=a)&&!(0<a&&"0"==a.charAt(0)):!0},"Het protocol getal moet een getal zijn van 0 tot 255."],[".port-add-rule",
function(a){var b=$("#modal-add-rule-protocol-getal").val();if("6"==b||"17"==b){if("*"==a)return!0;b=a.split(":");if(1==b.length){var c=b[0];return $.isNumeric(c)&&0<=c&&65535>=c&&!(0==c&&"0"!=c)&&!(0<c&&"0"==c.charAt(0))&&"-"!=c.charAt(0)}if(2==b.length){c=b[0];a=parseInt(c);var d=b[1],b=parseInt(d),c=$.isNumeric(c)&&0<=a&&65535>=a&&!(0==a&&"0"!=c)&&!(0<a&&"0"==c.charAt(0))&&"-"!=c.charAt(0),d=$.isNumeric(d)&&0<=b&&65535>=b&&!(0==b&&"0"!=b)&&!(0<b&&"0"==d.charAt(0))&&"-"!=d.charAt(0);return c&&d&&
a<=b}return!1}return!0},"Ongeldig poort-formaat aangetroffen. Een geldige poort is bijvoorbeeld poort '80' of '22:30', of '*' voor alle poorten. Geldig formaat: interval van poorten als 'x:y' met 0 &lt;= x &lt;= 65535 en 0 &lt;= y &lt;= 65535 en x &lt;= y of een enkele poort als 'x' met 0 &lt;= x &lt;= 65535 of alle poorten als '*'."],["#modal-change-rule-protocol-getal",function(a){return-1!=$("#modal-change-rule-protocol-choose").val()?$.isNumeric(a)&&255>=a&&0<=a&&!(0==a&&"0"!=a)&&!(0<a&&"0"==
a.charAt(0)):!0},"Het protocol getal moet een getal zijn van 0 tot 255."],[".port-change-rule",function(a){var b=$("#modal-change-rule-protocol-getal").val();if("6"==b||"17"==b){if("*"==a)return!0;b=a.split(":");if(1==b.length)return a=b[0],$.isNumeric(a)&&0<=a&&65535>=a&&!(0<a&&"0"==a.charAt(0))&&"-"!=a.charAt(0);if(2==b.length){a=b[0];var b=b[1],c=$.isNumeric(a)&&0<=a&&65535>=a&&!(0==a&&"0"!=a)&&!(0<a&&"0"==a.charAt(0))&&"-"!=a.charAt(0),d=$.isNumeric(b)&&0<=b&&65535>=b&&!(0==b&&"0"!=b)&&!(0<b&&
"0"==b.charAt(0))&&"-"!=b.charAt(0);return c&&d&&parseInt(a)<=parseInt(b)}return!1}return!0},"Ongeldig poort-formaat aangetroffen. Een geldige poort is bijvoorbeeld poort '80' of '22:30', of '*' voor alle poorten. Geldig formaat: interval van poorten als 'x:y' met 0 &lt;= x &lt;= 65535 en 0 &lt;= y &lt;= 65535 en x &lt;= y of een enkele poort als 'x' met 0 &lt;= x &lt;= 65535 of alle poorten als '*'."],[".input-port",function(a){if("*"==a)return!0;var b=a.split(":");if(1==b.length)return a=b[0],$.isNumeric(a)&&
0<=a&&65535>=a&&!(0<a&&"0"==a.charAt(0))&&"-"!=a.charAt(0);if(2==b.length){a=b[0];var b=b[1],c=$.isNumeric(a)&&0<=a&&65535>=a&&!(0==a&&"0"!=a)&&!(0<a&&"0"==a.charAt(0))&&"-"!=a.charAt(0),d=$.isNumeric(b)&&0<=b&&65535>=b&&!(0==b&&"0"!=b)&&!(0<b&&"0"==b.charAt(0))&&"-"!=b.charAt(0);return c&&d&&parseInt(a)<=parseInt(b)}return!1},"Ongeldig poort-formaat aangetroffen. Een geldige poort is bijvoorbeeld poort '80' of '22:30', of '*' voor alle poorten. Geldig formaat: interval van poorten als 'x:y' met 0 &lt;= x &lt;= 65535 en 0 &lt;= y &lt;= 65535 en x &lt; y of een enkele poort als 'x' met 0 &lt;= x &lt;= 65535 of alle poorten als '*'."],
[".input-ip",function(a){if("*"==a)return!0;a=a.split("/");if(2==a.length){var b=a[0];a=a[1];var b=b.split("."),c=$.isNumeric(b[0])&&0<=b[0]&&255>=b[0]&&"-"!=b[0].charAt(0)&&!(0<b[0]&&"0"==b[0].charAt(0))&&!(0==b[0]&&"0"!=b[0]),d=$.isNumeric(b[1])&&0<=b[1]&&255>=b[1]&&"-"!=b[1].charAt(0)&&!(0<b[1]&&"0"==b[1].charAt(0))&&!(0==b[1]&&"0"!=b[1]),f=$.isNumeric(b[2])&&0<=b[2]&&255>=b[2]&&"-"!=b[2].charAt(0)&&!(0<b[2]&&"0"==b[2].charAt(0))&&!(0==b[2]&&"0"!=b[2]),g=$.isNumeric(b[3])&&0<=b[3]&&255>=b[3]&&
"-"!=b[3].charAt(0)&&!(0<b[3]&&"0"==b[3].charAt(0))&&!(0==b[3]&&"0"!=b[3]),b=4==b.length&&c&&d&&f&&g;a=$.isNumeric(a)&&0<=a&&32>=a&&!(0<a&&"0"==a.charAt(0))&&"-"!=a.charAt(0)&&!(0==a&&"0"!=a);return b&&a}return 1==a.length?(b=a[0],b=b.split("."),c=$.isNumeric(b[0])&&0<=b[0]&&255>=b[0]&&"-"!=b[0].charAt(0)&&!(0<b[0]&&"0"==b[0].charAt(0))&&!(0==b[0]&&"0"!=b[0]),d=$.isNumeric(b[1])&&0<=b[1]&&255>=b[1]&&"-"!=b[1].charAt(0)&&!(0<b[1]&&"0"==b[1].charAt(0))&&!(0==b[1]&&"0"!=b[1]),f=$.isNumeric(b[2])&&0<=
b[2]&&255>=b[2]&&"-"!=b[2].charAt(0)&&!(0<b[2]&&"0"==b[2].charAt(0))&&!(0==b[2]&&"0"!=b[2]),g=$.isNumeric(b[3])&&0<=b[3]&&255>=b[3]&&"-"!=b[3].charAt(0)&&!(0<b[3]&&"0"==b[3].charAt(0))&&!(0==b[3]&&"0"!=b[3]),b=4==b.length&&c&&d&&f&&g):!1},"Ongeldig IP-formaat aangetroffen. Een geldige invoer is bijvoorbeeld '192.168.0.0/16', of '*' voor alle IP adressen. Geldig formaat: 'x.x.x.x/y' met 0 &lt;= x &lt;= 255 en 0 &lt;= y &lt;= 32 of '*' indien alle IP-adressen toegelaten zijn. Een IP-adres van de vorm x.x.x.x is ook toegelaten."]],
t=function(a,b){},u=function(a,b){};0<$("#form-add-rule").length&&($("#form-add-rule").nod(r,q),$("#form-add-rule").on("silentSubmit",t));0<$("#form-change-rule").length&&($("#form-change-rule").nod(r,q),$("#form-change-rule").on("silentSubmit",u));$("#modal-add-rule-protocol-getal").on("change",function(){var a=$("#modal-add-rule-protocol-getal").val();"6"==a||"17"==a?($("#modal-add-rule-source-port").css("visibility","visible"),$("#modal-add-rule-destination-port").css("visibility","visible"),$("#modal-add-rule-source-port-text").css("visibility",
"visible"),$("#modal-add-rule-destination-port-text").css("visibility","visible"),$("#modal-add-rule-source-port").next().show(),$("#modal-add-rule-destination-port").next().show()):($("#modal-add-rule-source-port").css("visibility","hidden"),$("#modal-add-rule-destination-port").css("visibility","hidden"),$("#modal-add-rule-source-port-text").css("visibility","hidden"),$("#modal-add-rule-destination-port-text").css("visibility","hidden"),$("#modal-add-rule-source-port").next().hide(),$("#modal-add-rule-destination-port").next().hide())});
$("#modal-change-rule-protocol-getal").on("change",function(){var a=$("#modal-change-rule-protocol-getal").val();"6"==a||"17"==a?($("#modal-change-rule-source-port").css("visibility","visible"),$("#modal-change-rule-destination-port").css("visibility","visible"),$("#modal-change-rule-source-port-text").css("visibility","visible"),$("#modal-change-rule-destination-port-text").css("visibility","visible"),$("#modal-change-rule-source-port").next().show(),$("#modal-change-rule-destination-port").next().show(),
$("#form-change-rule").nod(r,q)):($("#modal-change-rule-source-port").css("visibility","hidden"),$("#modal-change-rule-destination-port").css("visibility","hidden"),$("#modal-change-rule-source-port-text").css("visibility","hidden"),$("#modal-change-rule-destination-port-text").css("visibility","hidden"),$("#modal-change-rule-source-port").next().hide(),$("#modal-change-rule-destination-port").next().hide())});$(".segment-content-link").click(function(){h&&h.abort();var a=$(this).data("segment-number"),
b=$(this).data("compact");h=$.ajax({url:"/my_configuration/segment_content;jsessionid="+$("body").data("session")+"?segment_number="+a+"&compact="+b,dataType:"json",type:"get"});h.success(function(b,d,f){$("#modal-segment-content-title-segment-number").html(a);b.compact?($("#modal-segment-content-title-compact").html("compacte weergave"),$("#modal-segment-content-body-text-compact").show()):($("#modal-segment-content-body-text-compact").hide(),$("#modal-segment-content-title-compact").html("uitgebreide weergave"));
b.toonbaar?($("#modal-segment-content-body-datatable").dataTable({bSort:!1,bFilter:!1,bLengthChange:!1,bRetrieve:!1,bDestroy:!0,oLanguage:{sProcessing:"Bezig met verwerking...",sLengthMenu:"Toon _MENU_ regels per pagina",sZeroRecords:"Het segment bevat geen regels",sInfo:"_START_ tot _END_ van _TOTAL_ regels",sInfoEmpty:"0 tot 0 van _TOTAL_ regels",sSearch:"Zoeken:",sEmptyTable:"Geen inhoud aanwezig in het segment",sInfoFiltered:"Gefilterd uit _MAX_ regels",sInfoThousands:".",sLoadingRecords:"Even geduld aub...",
sInfoPostFix:"",oPaginate:{sFirst:"Eerste",sLast:"Laatste",sNext:"",sPrevious:""}},aaData:b.aaData}),$("#modal-segment-content-body-error").hide(),$("#modal-segment-content-body-span").hide(),$("#modal-segment-content-body-text-intro").show(),$("#modal-segment-content-body-div").show()):($("#modal-segment-content-body-text-intro").hide(),$("#modal-segment-content-body-error").hide(),$("#modal-segment-content-body-div").hide(),$("#modal-segment-content-body-span").show())});h.fail(function(b,d,f){$("#modal-segment-content-title-segment-number").html(a);
$("#modal-segment-content-title-compact").html("foutmelding");$("#modal-segment-content-body-div").hide();$("#modal-segment-content-body-span").hide();$("#modal-segment-content-body-error").html(b.responseText);$("#modal-segment-content-body-error").show()});h.always(function(){$("#modal-segment-content").modal("show")})});$(".button-show-redundant-rules").click(function(){h&&h.abort();h=$.ajax({url:"/my_configuration/show_redundancy;jsessionid="+$("body").data("session"),dataType:"json",type:"get"});
h.success(function(a,b,c){0<a.iTotalRecords?($("#modal-redundant-rules-body-datatable").dataTable({bSort:!1,bFilter:!1,bLengthChange:!1,bRetrieve:!1,bDestroy:!0,oLanguage:{sProcessing:"Bezig met verwerking...",sLengthMenu:"Toon _MENU_ firewallregels per pagina",sZeroRecords:"Geen redundante firewallregels",sInfo:"_START_ tot _END_ van _TOTAL_ firewallregels",sInfoEmpty:"0 tot 0 van _TOTAL_ firewallregels",sSearch:"Zoeken:",sEmptyTable:"Huidige chain bevat geen redundanties",sInfoFiltered:"Gefilterd uit _MAX_ firewallregels",
sInfoThousands:".",sLoadingRecords:"Even geduld aub...",sInfoPostFix:"",oPaginate:{sFirst:"Eerste",sLast:"Laatste",sNext:"",sPrevious:""}},aaData:a.aaData}),$("#remove-redundant-rules").show(),$("#modal-redundant-rules-body-error").hide(),$("#modal-redundant-rules-body-span").hide(),$("#modal-redundant-rules-body-div").show()):($("#remove-redundant-rules").hide(),$("#modal-redundant-rules-body-error").hide(),$("#modal-redundant-rules-body-div").hide(),$("#modal-redundant-rules-body-span").show())});
h.fail(function(a,b,c){$("#modal-redundant-rules-body-div").hide();$("#modal-redundant-rules-body-span").hide();$("#modal-redundant-rules-body-error").html(a.responseText);$("#modal-redundant-rules-body-error").show()});h.always(function(){$("#modal-redundant-rules").modal("show")})})});